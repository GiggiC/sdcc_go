{{define "title"}}Dashboard Example{{end}}

{{define "body"}}

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">

        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Notifications</h1>
        </div>

        <table id="example" class="table table-striped">
        </table>

        <script>

            $(document).ready(function () {

                if (navigator.geolocation) { // Supported
                    navigator.geolocation.getCurrentPosition(getPosition);
                } else { // Not supported
                    alert("Oops! This browser does not support HTML Geolocation.");
                }
            });

            function getPosition(position) {

                const latitude = position.coords.latitude;
                const longitude = position.coords.longitude;

                $.ajax({

                    url: "/notifications",
                    data: {latitude: latitude, longitude: longitude}, //If the request needs any data

                    success: function (result) {

                        if (result != null) {

                            var table = $('#example');
                            var tblHeader = "<thead><tr>";
                            var i = 0;
                            for (var k in result[0]) {
                                if (i < 2) {
                                    tblHeader += "<th>" + k + "</th>";
                                }
                                i += 1;
                            }
                            tblHeader += "</tr></thead><tbody>";
                            $(tblHeader).appendTo(table);
                            $.each(result, function (index, value) {
                                var TableRow = "<tr>";
                                i = 0;
                                $.each(value, function (key, val) {
                                    if (i < 2) {
                                        TableRow += "<td>" + val + "</td>";
                                    }
                                    i += 1;
                                });
                                TableRow += "</tr></tbody>";
                                $(table).append(TableRow);
                            });

                            table.DataTable();
                        }
                    }
                })
            }
        </script>
    </main>
{{end}}

